<div class="row">
    <div class="col-12">
        <div class="card">
            <div class="card-body">

                <!-- <div class="d-flex justify-content-between"> -->
                <!-- <div class="row"> -->
                <!-- <div class="container"> -->

                <div class="container row">
                    <div class="col-md-6 col-12">
                        <h3 class="text-muted m-t-10 m-b-0">Ventas</h3>
                    </div>
                    <div class="col-md-2 col-12"></div>
                    <div class="col-md-2 col-12">Estatus:
                        <p [ngSwitch]=EstatusOC>
                            <span *ngSwitchCase="'Guardada'" class="label label-light-info">GUARDADA</span>
                            <span *ngSwitchCase="'Cerrada'" class="label label-light-danger">CERRADA</span>
                            <span *ngSwitchCase="'Duplicada'" class="label label-light-inverse">DUPLICADA</span>
                        </p>
                    </div>
                    <div class="col-md-2 col-12">
                        Tipo de Venta: {{service.formDataPedido.Flete}}
                    </div>
                </div>



                <!-- <div class="col-12">
        <div class="col-4">

            <h3 class="text-muted m-t-10 m-b-0">Ventas</h3>
        </div>
        <div class="col-4">

            <div>
                Estatus:
                <p [ngSwitch]=EstatusOC>
                    <span *ngSwitchCase="'Guardada'" class="label label-light-info">GUARDADA</span>
                    <span *ngSwitchCase="'Cerrada'" class="label label-light-danger">CERRADA</span>
                    <span *ngSwitchCase="'Duplicada'" class="label label-light-inverse">DUPLICADA</span>
                </p>
            </div>
        </div>
        <div class="col-4">
            Tipo de Venta: {{service.formDataPedido.Flete}}
        </div>
    </div> -->
                <!-- </div> -->
                <!-- </div> -->
                <!-- <button class="mt-2" mat-raised-button (click)="Regresar()" color="primary">Regresar</button> -->
                <button mat-fab (click)="Regresar()" class="btncoti">
        <mat-icon>undo</mat-icon>
      </button>

                <!-- </div> -->



                <hr>


                <div class="col-12 mat-elevation-z5">
                    <div class="card">
                        <div class="card-body body">


                            <!-- Step 1 -->

                            <section>
                                <!-- va en el ngform -->
                                <!--   updateReciboPago(reciboPago: ReciboPago) {
    return this.http.put(this.APIUrl + '/ReciboPago', reciboPago);
  } -->

                                <div class="form-material" id="general">

                                    <mat-horizontal-stepper class="body" [linear]="isLinear" #stepper>
                                        <mat-step [stepControl]="thirdFormGroup" style="background-color: whitesmoke">
                                            <form>
                                                <ng-template matStepLabel></ng-template>
                                                <div class="col-12" style="text-align: center;">
                                                    <h3>Generales</h3>
                                                </div>
                                                <br>
                                                <div id="step1">
                                                    <div class="container">
                                                        <div class="row">

                                                            <div class="col-12 col-md-6">
                                                                <label class="input-group-text text-info">IdPedido:</label>
                                                                <input type="text" class="form-control" name="IdPedido" #IdPedido="ngModel" [(ngModel)]="service.formDataPedido.IdPedido" readonly>

                                                                <label class="input-group-text text-info">Folio:</label>
                                                                <input type="text" class="form-control" name="Folio" #Folio="ngModel" [(ngModel)]="service.formDataPedido.Folio" readonly>

                                                                <label class="input-group-text text-info">Observaciones:</label>
                                                                <input type="text" class="form-control" name="Observaciones" #Observaciones="ngModel" [(ngModel)]="service.formDataPedido.Observaciones">

                                                                <!-- <label class="input-group-text text-info">Fecha Vencimiento:</label>
                                            <mat-datepicker-toggle matSuffix [for]="picker1"></mat-datepicker-toggle>
                                            <input type="text" readonly="readonly" [matDatepicker]="picker1" class="form-control" name="FechaVencimiento" #FechaVencimiento="ngModel" [(ngModel)]="service.formDataPedido.FechaVencimiento">
                                            <mat-datepicker #picker1></mat-datepicker> -->

                                                                <label class="input-group-text text-info">Moneda</label>
                                                                <select class="form-control" name="Moneda" #Moneda="ngModel" id="Moneda" (change)="MonedaSelected($event)" [(ngModel)]="service.formDataPedido.Moneda">
                                                <option [ngValue]="null" selected disabled>Seleccionar Moneda</option>
                                                <option *ngFor="let dl of listMoneda" [ngValue]="dl.Moneda"> {{dl.Moneda}} </option>
                                            </select>

                                                                <div *ngIf="MonedaBoolean == true; else elseBlockDlls">

                                                                    <label class="input-group-text text-info">Descuento:</label>
                                                                    <input type="text" class="form-control" name="Descuento" #Descuento="ngModel" (blur)="onBlurDescuento()" [(ngModel)]="service.formDataPedido.Descuento">

                                                                </div>
                                                                <ng-template #elseBlockDlls>

                                                                    <label class="input-group-text text-info">DescuentoDlls:</label>
                                                                    <input type="text" class="form-control" name="DescuentoDlls" #DescuentoDlls="ngModel" (blur)="onBlurDescuentoDlls()" [(ngModel)]="service.formDataPedido.DescuentoDlls">

                                                                </ng-template>

                                                                <label class="input-group-text text-info">Requiere Factura:</label>
                                                                <mat-checkbox #checkbox1 [(checked)]="isFactura" (change)='changeFactura(checkbox1.checked)'></mat-checkbox>

                                                                <br>
                                                                <label class="input-group-text text-info">Flete:</label>
                                                                <mat-checkbox #checkbox [(checked)]="isFlete" [disabled]="valores == true" (change)='changeFlete(checkbox.checked)'></mat-checkbox>

                                                                <div *ngIf="isFlete == true">
                                                                    <label class="input-group-text text-info">Tipo de Flete:</label>
                                                                    <select [disabled]="valores == true" placeholder="Seleccionar Flete" class="form-control" name="Flete" #Flete="ngModel" (change)="FleteSelected($event)" [(ngModel)]="service.formDataPedido.Flete">
                                                    <option [ngValue]="null" selected disabled>Seleccionar Flete</option>
                                                    <option *ngFor="let lf of listFlete" [ngValue]="lf.Flete"> {{lf.Flete}} </option>
                                                </select>
                                                                </div>





                                                            </div>
                                                            <div class="col-md-6 col-12">
                                                                <label class="input-group-text text-info">Orden de Compra:</label>
                                                                <input type="text" class="form-control" name="OrdendeCompra" #OrdendeCompra="ngModel" [(ngModel)]="service.formDataPedido.OrdenDeCompra">

                                                                <label class="input-group-text text-info">Fecha de Entrega:</label>
                                                                <mat-datepicker-toggle matSuffix [for]="picker2"></mat-datepicker-toggle>
                                                                <input type="text" readonly="readonly" [matDatepicker]="picker2" class="form-control" name="FechaDeEntrega" #FechaDeEntrega="ngModel" [(ngModel)]="service.formDataPedido.FechaDeEntrega">
                                                                <mat-datepicker #picker2></mat-datepicker>

                                                                <label class="input-group-text text-info">Condiciones De Pago:</label>
                                                                <input type="text" class="form-control" name="CondicionesDePago" #CondicionesDePago="ngModel" [(ngModel)]="service.formDataPedido.CondicionesDePago">

                                                                <label class="input-group-text text-info">Vendedor:</label>
                                                                <mat-form-field>
                                                                    <input type="text" placeholder="Seleccionar Vendedor" aria-label="Number" [formControl]="myControlVendedor" [(ngModel)]="service.formDataPedido.Vendedor" matInput [matAutocomplete]="autoVendedor">
                                                                    <mat-autocomplete #autoVendedor="matAutocomplete">
                                                                        <mat-option *ngFor="let option of filteredOptionsVendedor | async" [value]="option.IdVendedor" (onSelectionChange)="onSelectionChangeVendedor(option, $event)">
                                                                            {{option.IdVendedor}} {{option.Nombre}}
                                                                        </mat-option>
                                                                    </mat-autocomplete>
                                                                </mat-form-field>
                                                                <input readonly placeholder="Vendedor No seleccionado" type="text" class="form-control" [(ngModel)]="NombreVendedor" name="first">


                                                                <label class="input-group-text text-info">Prioridad:</label>
                                                                <!-- <input type="text" class="form-control" name="Prioridad" #Prioridad="ngModel" [(ngModel)]="service.formDataPedido.Prioridad"> -->
                                                                <select class="form-control" name="Prioridad" #Prioridad="ngModel" [(ngModel)]="service.formDataPedido.Prioridad">
                                                <option [ngValue]="null" selected disabled>Seleccionar Prioridad</option>
                                                <option *ngFor="let dl of listPrioridad" [ngValue]="dl.Prioridad"> {{dl.Prioridad}} </option>
                                            </select>


                                                            </div>

                                                        </div>
                                                    </div>

                                                </div>
                                            </form>

                                            <div class="container row">
                                                <div class="col-md-10"></div>
                                                <div class="col-12 col-md-2">
                                                    <br>
                                                    <!-- <button class="btn btn-info btn-md float-md-right" matStepperNext></button> -->
                                                    <button class="btn btn-prolacto " mat-raised-button matStepperNext><i class="mdi mdi-arrow-right-bold-circle btn-lg"></i>Siguiente</button>
                                                </div>
                                            </div>
                                            <br>

                                        </mat-step>
                                        <!--      <mat-step [stepControl]="firstFormGroup">
                            <form>
                                <ng-template matStepLabel>Cliente</ng-template>
                                <label class="input-group-text text-info">Cliente :</label> <br>

                                <mat-form-field>
                                    <input type="text" placeholder="Seleccionar Cliente" aria-label="Number" [formControl]="myControl" matInput [matAutocomplete]="auto" [(ngModel)]="service.formData.IdClientes" name="IdClientes">
                                    <mat-autocomplete #auto="matAutocomplete">
                                        <mat-option *ngFor="let option of filteredOptions | async" [value]="option.IdClientes" (blur)="onBlurCliente()" (onSelectionChange)="onSelectionChange(option, $event)">
                                            {{option.IdClientes}} {{option.Nombre}}
                                        </mat-option>
                                    </mat-autocomplete>
                                </mat-form-field>
                                <div class="container">
                                    <div class="row">
                                        <div class="col-12 col-md-6">
                                            <div *ngIf="ClienteSeleccionado == true" [style.display]="clienteLogin ? 'none' : 'block'">
                                                <label class="input-group-text text-info">Otra Direccion:</label>
                                                <mat-checkbox #checkboxDireccion [(checked)]="isDireccion" (change)='changeDireccion(checkboxDireccion.checked)'></mat-checkbox>
                                            </div>

                                        </mat-step> -->
                                        <mat-step [stepControl]="firstFormGroup">
                                            <form id='step2'>
                                                <ng-template matStepLabel></ng-template>
                                                <div class="col-12" style="text-align: center;">
                                                    <h3>Cliente</h3>
                                                </div>
                                                <!-- <label class="input-group-text text-info">Cliente :</label> <br> -->

                                                <mat-form-field>
                                                    <input type="text" placeholder="Seleccionar Cliente" aria-label="Number" [formControl]="myControl" matInput [matAutocomplete]="auto" [(ngModel)]="this.service.formData.IdClientes" name="IdClientes">
                                                    <mat-autocomplete CdkScrollable #auto="matAutocomplete">
                                                        <mat-option *ngFor="let option of filteredOptions | async" [value]="option.IdClientes" (blur)="onBlurCliente()" (onSelectionChange)="onSelectionChange(option, $event)">
                                                            {{option.IdClientes}} {{option.Nombre}}
                                                        </mat-option>
                                                    </mat-autocomplete>
                                                </mat-form-field>
                                                <div class="container">
                                                    <div class="row">
                                                        <div class="col-12 col-md-6">
                                                            <div *ngIf="ClienteSeleccionado == true">
                                                                <label class="input-group-text text-info">Otra Direccion:</label>
                                                                <mat-checkbox #checkboxDireccion [(checked)]="isDireccion" (change)='changeDireccion(checkboxDireccion.checked)'></mat-checkbox>
                                                            </div>
                                                            <br>
                                                            <div *ngIf="isDireccion == true">
                                                                <button mat-icon-button class="btn btn-success" (click)="AbrirDireccionCliente(service.formData.IdClientes)"><mat-icon>add_location</mat-icon></button>
                                                                <label class="input-group-text text-info">Direccion:</label>
                                                                <mat-form-field>
                                                                    <input type="text" placeholder="Seleccionar Direccion" aria-label="Number" [formControl]="myControlDireccion" [ngModel]="IdDireccion" matInput [matAutocomplete]="autoDireccion">
                                                                    <mat-autocomplete #autoDireccion="matAutocomplete">
                                                                        <mat-option *ngFor="let option of filteredOptionsDireccion | async" [value]="option.IdDireccion" (onSelectionChange)="onSelectionChangeDireccion(option, $event)">
                                                                            {{option.Calle}} | {{option.Colonia}} | {{option.CP}} | {{option.Calle}} | {{option.Ciudad}} | {{option.Estado}} | {{option.NumeroExterior}}
                                                                        </mat-option>
                                                                    </mat-autocomplete>
                                                                </mat-form-field>
                                                            </div>
                                                            <br>
                                                            <label class="input-group-text text-info">Nombre :</label>
                                                            <input type="text" class="form-control" name="Nombre" #Nombre="ngModel" [(ngModel)]="service.formData.Nombre" readonly>

                                                            <label class="input-group-text text-info">RFC :</label>
                                                            <input type="text" class="form-control" name="RFC" #RFC="ngModel" [(ngModel)]="service.formData.RFC" readonly>

                                                            <label class="input-group-text text-info">Razon Social :</label>
                                                            <input type="text" class="form-control" name="RazonSocial" #RazonSocial="ngModel" [(ngModel)]="service.formData.RazonSocial" readonly>

                                                        </div>
                                                        <div class="col-12 col-md-6">
                                                            <label class="input-group-text text-info">Lugar de Entrega:</label>
                                                            <input type="text" class="form-control" name="LugarDeEntrega" #LugarDeEntrega="ngModel" [(ngModel)]="service.formDataPedido.LugarDeEntrega">

                                                            <label class="input-group-text text-info">Calle :</label>
                                                            <input type="text" class="form-control" name="Calle" #Calle="ngModel" [(ngModel)]="service.formData.Calle" readonly>

                                                            <label class="input-group-text text-info">Colonia :</label>
                                                            <input type="text" class="form-control" name="Colonia" #Colonia="ngModel" [(ngModel)]="service.formData.Colonia" readonly>


                                                            <label class="input-group-text text-info">CP :</label>
                                                            <input type="text" class="form-control" name="CP" #CP="ngModel" [(ngModel)]="service.formData.CP" readonly>

                                                            <label class="input-group-text text-info">Ciudad :</label>
                                                            <input type="text" class="form-control" name="Ciudad" #Ciudad="ngModel" [(ngModel)]="service.formData.Ciudad" readonly>

                                                            <label class="input-group-text text-info">Estado :</label>
                                                            <input type="text" class="form-control" name="Estado" #Estado="ngModel" [(ngModel)]="service.formData.Estado" readonly>

                                                            <label class="input-group-text text-info">NumeroExterior :</label>
                                                            <input type="text" class="form-control" name="NumeroExterior" #NumeroExterior="ngModel" [(ngModel)]="service.formData.NumeroExterior" readonly>

                                                            <label class="input-group-text text-info">NumeroInterior :</label>
                                                            <input type="text" class="form-control" name="NumeroInterior" #NumeroInterior="ngModel" [(ngModel)]="service.formData.NumeroInterior" readonly>


                                                            <!-- <label class="input-group-text text-info">ClaveCliente :</label>
                                            <input type="text" class="form-control" name="ClaveCliente" #ClaveCliente="ngModel" [(ngModel)]="service.formData.ClaveCliente" readonly> -->

                                                            <!-- <label class="input-group-text text-info">Estatus :</label>
                                            <input type="text" class="form-control" name="Estatus" #Estatus="ngModel" [(ngModel)]="service.formData.Estatus" readonly> -->

                                                            <!-- <label class="input-group-text text-info">LimiteCredito :</label>
                                            <input type="text" class="form-control" name="LimiteCredito" #LimiteCredito="ngModel" [(ngModel)]="service.formData.LimiteCredito" readonly>

                                            <label class="input-group-text text-info">DiasCredito :</label>
                                            <input type="text" class="form-control" name="DiasCredito" #DiasCredito="ngModel" [(ngModel)]="service.formData.DiasCredito" readonly> -->

                                                            <!-- <label class="input-group-text text-info">MetodoPago :</label>
                                            <input type="text" class="form-control" name="MetodoPago" #MetodoPago="ngModel" [(ngModel)]="service.formData.MetodoPago" readonly> -->

                                                            <!-- <label class="input-group-text text-info">UsoCFDI :</label>
                                            <input type="text" class="form-control" name="UsoCFDI" #UsoCFDI="ngModel" [(ngModel)]="service.formData.UsoCFDI" readonly> -->

                                                            <!-- <label class="input-group-text text-info">IdApi :</label>
                                            <input type="text" class="form-control" name="IdApi" #IdApi="ngModel" value="" [(ngModel)]="service.formData.IdApi" readonly> -->
                                                            <div>
                                                            </div>
                                                        </div>


                                                        <div class="container row">
                                                            <div class="col-12 col-md-4">
                                                                <br>
                                                                <!-- <button matStepperPrevious class="btn btn-primary btn-md">Back</button> -->
                                                                <button class="btn btn-prolacto " mat-raised-button matStepperPrevious><i class="mdi mdi-arrow-left-bold-circle btn-lg"></i>Atras</button>
                                                            </div>
                                                            <div class="col-4"></div>
                                                            <div class="col-12 col-md-4">
                                                                <br>
                                                                <!-- <button matStepperNext class="btn btn-info btn-md">Next</button> -->
                                                                <button class="btn btn-prolacto " mat-raised-button matStepperNext><i class="mdi mdi-arrow-right-bold-circle btn-lg"></i>Siguiente</button>
                                                            </div>
                                                        </div>
                                                        <br>

                                                    </div>
                                                </div>
                                            </form>
                                        </mat-step>

                                        <mat-step [stepControl]="secondFormGroup">

                                            <ng-template matStepLabel></ng-template>
                                            <div class="col-12" style="text-align: center;">
                                                <h3>Producto</h3>
                                            </div>
                                            <div id='step3'>
                                                <form #DetallePedidoForm="ngForm">
                                                    <!-- {{seleccionManual}} {{service.formDataPedido.Flete}} -->
                                                    <div *ngIf=" ((service.formDataPedido.Flete == 'Paqueteria') || (service.formDataPedido.Flete == 'Local') || (service.formDataPedido.Flete == 'Foraneo')) && (seleccionManual == false)" class="row">

                                                        <div class="col-md-6 col-12">

                                                            <label class="input-group-text text-info">Producto :</label> <br>
                                                            <mat-form-field>
                                                                <input type="text" placeholder="Seleccionar Producto" aria-label="Number" [formControl]="myControl2" [(ngModel)]="ProductoSelect" matInput [matAutocomplete]="autoProducto">
                                                                <mat-autocomplete #autoProducto="matAutocomplete">
                                                                    <mat-option *ngFor="let option of filteredOptions2 | async" [value]="option.Nombre" (onSelectionChange)="onSelectionChange2(option, $event)">
                                                                        {{option.Nombre}}
                                                                    </mat-option>
                                                                </mat-autocomplete>
                                                            </mat-form-field>

                                                        </div>

                                                        <div class="col-md-6 col-12">
                                                            <label class="input-group-text text-info">Marca :</label> <br>
                                                            <mat-form-field>
                                                                <input type="text" placeholder="Seleccionar Marca" aria-label="Number" [formControl]="myControl3" [(ngModel)]="MarcaSelect" matInput [matAutocomplete]="autoMarcaProducto">
                                                                <mat-autocomplete #autoMarcaProducto="matAutocomplete">
                                                                    <mat-option *ngFor="let option of filteredOptions3 | async" [value]="option.NombreMarca" (onSelectionChange)="onSelectionChangeMarca(option, $event)">
                                                                        {{option.NombreMarca}}
                                                                    </mat-option>
                                                                </mat-autocomplete>
                                                            </mat-form-field>
                                                        </div>

                                                    </div>

                                                    <div *ngIf=" ((service.formDataPedido.Flete == 'Paqueteria') || (service.formDataPedido.Flete == 'Local') || (service.formDataPedido.Flete == 'Foraneo')) && (seleccionManual == false)" class="row">

                                                        <div class="col-md-6 col-12">
                                                            <label class="input-group-text text-info">Origen :</label> <br>
                                                            <mat-form-field>
                                                                <input type="text" placeholder="Seleccionar Origen" aria-label="Number" [formControl]="myControl4" [(ngModel)]="OrigenSelect" matInput [matAutocomplete]="autoOrigenProducto">
                                                                <mat-autocomplete #autoOrigenProducto="matAutocomplete">
                                                                    <mat-option *ngFor="let option of filteredOptions4 | async" [value]="option.NombreOrigen" (onSelectionChange)="onSelectionChangeOrigen(option, $event)">
                                                                        {{option.NombreOrigen}}
                                                                    </mat-option>
                                                                </mat-autocomplete>
                                                            </mat-form-field>
                                                        </div>
                                                        <div class="col-md-6 col-12">
                                                            <label class="input-group-text text-info">Presentacion :</label> <br>
                                                            <mat-form-field>
                                                                <input type="text" placeholder="Seleccionar Presentacion" aria-label="Number" [formControl]="myControl5" [(ngModel)]="PresentacionSelect" matInput [matAutocomplete]="autoPresentacionProducto">
                                                                <mat-autocomplete #autoPresentacionProducto="matAutocomplete">
                                                                    <mat-option *ngFor="let option of filteredOptions5 | async" [value]="option.Presentacion" (onSelectionChange)="onSelectionChangePresentacion(option, $event)">
                                                                        {{option.Presentacion}}
                                                                    </mat-option>
                                                                </mat-autocomplete>
                                                            </mat-form-field>
                                                        </div>
                                                    </div>

                                                    <!-- <div *ngIf="this.seleccionManual == true" class="row"> -->
                                                    <div [hidden]="this.seleccionManual == false" class="row">
                                                        <div class="col-12">
                                                            <div class="card">
                                                                <div class="card-body">

                                                                    <!-- <h1 style="text-align: center;">Seleccionar Mercancia</h1> -->

                                                                    <div class="row">

                                                                        <div class="col-md-4 col-sm-12" style="display: griblockd; justify-content: center">

                                                                            <!-- <button [(disabled)]="aceptarSeleccion" style="margin-right: 15px;" mat-fab (click)="seleccionarSeleccion()" class="btncoti">
                                                                                <mat-icon>note_add</mat-icon>
                                                                              </button> -->


                                                                        </div>
                                                                        <div class="col-md-4 col-sm-12" style="display: grid">


                                                                            <!-- <mat-form-field>
                                                                                <mat-label> Bodega </mat-label>
                                                
                                                                                <mat-select (selectionChange)="bodegaCambio($event)" name="bodegaSELEC" [(ngModel)]="bodegaSelectSeleccion">
                                                
                                                                                    <mat-option *ngFor="let dl of listBodega" [value]="dl.Bodega"> {{dl.Bodega}} </mat-option>
                                                                                </mat-select>
                                                                            </mat-form-field> -->

                                                                        </div>
                                                                        <div class="col-md-4 col-sm-12" style="display: grid">


                                                                            <mat-form-field style="display: block">
                                                                                <input matInput (keyup)="applyFilterSeleccion($event.target.value)" placeholder="Buscar">
                                                                            </mat-form-field>


                                                                        </div>

                                                                    </div>




                                                                    <!-- <div class="mat-elevation-z8 container">
                                                                        <div style="overflow:auto;">
                                                
                                                                            <div>
                                                                                <table style="width: 100% " mat-table [dataSource]="listData2" matSort>
                                                
                                                                                    <tr mat-header-row *matHeaderRowDef="displayedColumns2"></tr>
                                                                                    <tr mat-row *matRowDef="let row; columns: displayedColumns2;"></tr>
                                                
                                                                                    <ng-container matColumnDef="ClaveProducto">
                                                                                        <th mat-header-cell *matHeaderCellDef mat-sort-header>Clave Producto</th>
                                                                                        <td mat-cell *matCellDef="let element">{{element.ClaveProducto}}</td>
                                                                                    </ng-container>
                                                                           
                                                                                    <ng-container matColumnDef="Producto">
                                                                                        <th mat-header-cell *matHeaderCellDef mat-sort-header>Producto</th>
                                                                                        <td mat-cell *matCellDef="let element">{{element.Producto}}</td>
                                                                                    </ng-container>
                                                                                    <ng-container matColumnDef="Cantidad">
                                                                                        <th mat-header-cell *matHeaderCellDef mat-sort-header>Cantidad</th>
                                                                                        <td mat-cell *matCellDef="let element">{{element.Cantidad}}</td>
                                                                                    </ng-container>
           
                                                                                </table>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                
                                                
                                                                    <hr> -->


                                                                    <div class="mat-elevation-z8 container">
                                                                        <div style="overflow:auto;">

                                                                            <table mat-table style="width: 100% " [dataSource]="listDataSeleccion" matSort class="scrollable" multiTemplateDataRows>



                                                                                <!-- <ng-container matColumnDef="select">
                                                                                    <th mat-header-cell *matHeaderCellDef>
                                                                                        <mat-checkbox class="btncoti" (change)="$event ? masterToggle() : null" [checked]="selection.hasValue() && isAllSelected()" [indeterminate]="selection.hasValue() && !isAllSelected()" [aria-label]="checkboxLabel()">
                                                                                        </mat-checkbox>
                                                                                    </th>
                                                                                    <td mat-cell *matCellDef="let row">
                                                                                        <mat-checkbox class="btncoti" (click)="$event.stopPropagation()" (change)="$event ? selection.toggle(row) : null" (change)="toggle(row)" [checked]="selection.isSelected(row)" [aria-label]="checkboxLabel(row)">
                                                                                        </mat-checkbox>
                                                                                    </td>
                                                                                </ng-container> -->

                                                                                <tr mat-header-row *matHeaderRowDef="displayedColumnsSeleccion"></tr>
                                                                                <tr mat-row *matRowDef="let row; columns: displayedColumnsSeleccion;" (click)="selection.toggle(row)"></tr>



                                                                                <ng-container matColumnDef="Bodega">
                                                                                    <th mat-header-cell *matHeaderCellDef mat-sort-header>Bodega</th>
                                                                                    <td mat-cell *matCellDef="let element">{{element.Bodega}}
                                                                                    </td>
                                                                                </ng-container>

                                                                                <ng-container matColumnDef="Clave">
                                                                                    <th mat-header-cell *matHeaderCellDef mat-sort-header>Clave</th>
                                                                                    <td mat-cell *matCellDef="let element">{{element.ClaveProducto}}
                                                                                        <td>
                                                                                </ng-container>


                                                                                <ng-container matColumnDef="Producto">
                                                                                    <th mat-header-cell *matHeaderCellDef mat-sort-header>Producto</th>
                                                                                    <td mat-cell *matCellDef="let element">{{element.Producto }}

                                                                                    </td>
                                                                                </ng-container>

                                                                                <ng-container matColumnDef="Lote">
                                                                                    <th mat-header-cell *matHeaderCellDef mat-sort-header>Lote</th>
                                                                                    <td mat-cell *matCellDef="let element">{{element.Lote}}
                                                                                    </td>
                                                                                </ng-container>



                                                                                <ng-container matColumnDef="Fecha Caducidad">
                                                                                    <th mat-header-cell *matHeaderCellDef mat-sort-header>Fecha De Caducidad</th>
                                                                                    <td mat-cell *matCellDef="let element">{{element.FechaCaducidad | date: 'dd/MM/yyyy'}}
                                                                                    </td>
                                                                                </ng-container>

                                                                                <ng-container matColumnDef="Cantidad">
                                                                                    <th mat-header-cell *matHeaderCellDef mat-sort-header>Kg</th>
                                                                                    <td mat-cell *matCellDef="let element">{{element.PesoTotal}}
                                                                                    </td>
                                                                                </ng-container>
                                                                                <ng-container matColumnDef="Opciones">
                                                                                    <th mat-header-cell *matHeaderCellDef mat-sort-header>Agregar</th>
                                                                                    <td mat-cell *matCellDef="let row">
                                                                                        <button [style.display]="clienteLogin ? 'none' : 'block'" mat-icon-button class="btn btn-prolacto" (click)="toggle(row)">
                                                                                            <mat-icon>add</mat-icon>
                                                                                        </button>
                                                                                    </td>
                                                                                </ng-container>





                                                                            </table>
                                                                            <mat-paginator [pageSize]='5' [pageSizeOptions]='[5,10,25,50]' showFirstLastButtons>
                                                                            </mat-paginator>

                                                                        </div>
                                                                    </div>



                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>





                                                    <div class="container">
                                                        <div class="row">
                                                            <div class="col-12 col-md-6">
                                                                {{productoSeleccionado}}

                                                                <br>
                                                                <div *ngIf="MonedaBoolean == true; else elseBlockPC">

                                                                    <label class="input-group-text text-info"> Precio Costo :</label>
                                                                    <input type="number" class="form-control" name="PrecioCosto" #PrecioVenta="ngModel" [(ngModel)]="ProductoPrecio" (ngModelChange)="onChangePrecio($event)">

                                                                </div>
                                                                <ng-template #elseBlockPC>
                                                                    <label class="input-group-text text-info"> Precio Costo Dlls :</label>
                                                                    <input type="number" class="form-control" name="PrecioCostoDlls" #PrecioVenta="ngModel" [(ngModel)]="ProductoPrecioDLLS" (ngModelChange)="onChangePrecioDlls($event)">

                                                                </ng-template>

                                                                <label class="input-group-text text-info"> Cantidad Kg:</label>
                                                                <input type="number" class="form-control" name="Cantidad" [(ngModel)]="Cantidad" (ngModelChange)="onChangeCantidadP($event)">



                                                                <!-- <label class="input-group-text text-info"> ClaveProducto:</label>
                                                                <input type="text" class="form-control" name="ClaveProducto" #ClaveProducto="ngModel" [(ngModel)]="service.formProd.ClaveProducto" readonly>

                                                                <label class="input-group-text text-info"> Stock:</label>
                                                                <input type="text" class="form-control" name="Stock" #Stock="ngModel" [(ngModel)]="service.formProd.Stock" readonly>
 -->
                                                                <label *ngIf="seleccionManual == false" class="input-group-text text-info"> Descripcion Producto:</label>
                                                                <input *ngIf="seleccionManual == false" type="text" class="form-control" name="DescripcionProducto" #DescripcionProducto="ngModel" [(ngModel)]="service.formProd.DescripcionProducto" readonly>


                                                            </div>


                                                            <div class="col-12 col-md-6">



                                                                <!-- <label class="input-group-text text-info"> Estatus:</label>
                                                                <input type="text" class="form-control" name="Estatus" #Estatus="ngModel" [(ngModel)]="service.formProd.Estatus" readonly>
 -->
                                                                <label class="input-group-text text-info"> IVA:</label>
                                                                <input type="text" class="form-control" name="IVA" #IVA="ngModel" [(ngModel)]="service.formProd.IVA" readonly>

                                                                <label class="input-group-text text-info">Seleccion Manual</label>
                                                                <mat-checkbox [disabled]="valores == true || service.formDataPedido.Flete == 'Sucursal'" [(checked)]="seleccionManual" (change)='changeSeleccion($event)'></mat-checkbox>



                                                                <!--  <label class="input-group-text text-info">Clave SAT :</label>
                                                                <input type="text" class="form-control" name="ClaveSAT" #ClaveSAT="ngModel" [(ngModel)]="service.formProd.ClaveSAT" readonly>

                                                                <label class="input-group-text text-info">Observaciones :</label>
                                                                <input type="text" class="form-control" name="Observaciones" #Observaciones="ngModel" [(ngModel)]="service.formDataDP.Observaciones">

                                                                <label class="input-group-text text-info">Texto Extra :</label>
                                                                <input type="text" class="form-control" name="TextoExtra" #TextoExtra="ngModel" [(ngModel)]="service.formDataDP.TextoExtra">
 -->
                                                            </div>
                                                            <div class="container row">
                                                                <div class="col-md-7 col-lg-8">
                                                                </div>
                                                                <div class="col-12 col-md-5 col-lg-4">
                                                                    <div class="form-material borderbox">
                                                                        <div class="container">
                                                                            <div class="row">

                                                                                <div *ngIf="MonedaBoolean == true; else elseBlockImporteDlls">

                                                                                    <label class="input-group-text text-info col-12 col-md-6 col-lg-6">Importe</label>
                                                                                    <input class="form-control col-12 col-md-6 col-lg-6" readonly="readonly" name="ImporteP" [ngModel]=" MonedaBoolean ==  true ? (importeP | currency ): (importePDLLS | currency)">

                                                                                </div>
                                                                                <ng-template #elseBlockImporteDlls>

                                                                                    <label class="input-group-text text-info col-12 col-md-6 col-lg-6">Importe Dlls</label>
                                                                                    <input class="form-control col-12 col-md-6 col-lg-6" readonly="readonly" name="ImportePDlls" [ngModel]=" MonedaBoolean ==  true ? (importeP | currency ): (importePDLLS | currency)">


                                                                                </ng-template>

                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>


                                                    <div [style.display]="clienteLogin ? 'none' : 'block'" *ngIf="Cantidad > 0 && ActualizarDetallePedidoBool == false && ((ProductoPrecio > 0)||(ProductoPrecioDLLS>0))">
                                                        <button class="btn btn-dark" (click)="onAddProducto(DetallePedidoForm)">Agregar Producto</button>
                                                    </div>
                                                    <div [style.display]="clienteLogin ? 'none' : 'block'" *ngIf="ActualizarDetallePedidoBool != false">
                                                        <button class="btn btn-dark" (click)="OnEditDetallePedidodp(DetallePedidoForm)">Actualizar Producto</button>
                                                        <button class="btn btn-dark" (click)="Cancelar(DetallePedidoForm)">Cancelar</button>

                                                    </div>
                                                </form>

                                                <!--                           <div class='row'>
                                                    <button class="btn btn-dark" (click)="agregarProductos()">Seleccionar Producto</button>

                                                </div>
                                                <div class='row'>

                                                    <div class="col-6">
                                                        <div *ngIf="MonedaBoolean == true; else elseBlockPC">

                                                            <label class="input-group-text text-info"> Precio Costo :</label>
                                                            <input type="number" class="form-control" name="PrecioCosto" #PrecioVenta="ngModel" [(ngModel)]="ProductoPrecio" (ngModelChange)="onChangePrecio($event)">

                                                        </div>
                                                        <ng-template #elseBlockPC>
                                                            <label class="input-group-text text-info"> Precio Costo Dlls :</label>
                                                            <input type="number" class="form-control" name="PrecioCostoDlls" #PrecioVenta="ngModel" [(ngModel)]="ProductoPrecioDLLS" (ngModelChange)="onChangePrecioDlls($event)">

                                                        </ng-template>

                                                    </div>
                                                    <div class="col-6">

                                                        <label class="input-group-text text-info"> Cantidad:</label>
                                                        <input type="number" class="form-control" name="Cantidad" [(ngModel)]="Cantidad" (ngModelChange)="onChangeCantidadP($event)">

                                                        <label class="input-group-text text-info"> Descripcion Producto:</label>
                                                        <input type="text" class="form-control" name="DescripcionProducto" #DescripcionProducto="ngModel" [(ngModel)]="service.formProd.DescripcionProducto" readonly>

                                                    </div>


                                                </div>
                                                <div class='row'>
                                                    <button class="btn btn-dark" (click)="agregarProducto()">Agregar Producto</button>

                                                </div> -->

                                                <br>
                                                <hr>
                                                <mat-divider></mat-divider>
                                                <!-- <mat-card style="text-align: right;" class="mat-elevation-z0">
                                                    <mat-form-field>
                                                        <input matInput (keyup)="applyFilter($event.target.value)" placeholder="Filter">
                                                    </mat-form-field>
                                                </mat-card> -->
                                                <div class="row">
                                                    <div class="col-12 col-md-6">

                                                        <h2>Productos</h2>
                                                    </div>
                                                    <div class="col-12 col-md-4">


                                                    </div>
                                                    <div class="col-12 col-md-2">

                                                        {{cantidadTotalKg}} Kg.
                                                    </div>

                                                </div>
                                                <div #menu id='menu' class="mat-elevation-z8 container">
                                                    <div style="overflow:auto;">

                                                        <div>
                                                            <table style="width: 100% " mat-table [dataSource]="listData" matSort>

                                                                <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                                                                <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>

                                                                <ng-container matColumnDef="ClaveProducto">
                                                                    <th mat-header-cell *matHeaderCellDef mat-sort-header>Clave Producto</th>
                                                                    <td mat-cell *matCellDef="let element">{{element.ClaveProducto}}</td>
                                                                </ng-container>
                                                                <!--   <ng-container matColumnDef="ClaveSAT">
                                                                        <th mat-header-cell *matHeaderCellDef mat-sort-header>Clave SAT</th>
                                                                        <td mat-cell *matCellDef="let element">{{element.ClaveSAT}}</td>
                                                                    </ng-container> -->
                                                                <ng-container matColumnDef="Producto">
                                                                    <th mat-header-cell *matHeaderCellDef mat-sort-header>Producto</th>
                                                                    <td mat-cell *matCellDef="let element">{{element.Producto}}</td>
                                                                </ng-container>
                                                                <ng-container matColumnDef="Cantidad">
                                                                    <th mat-header-cell *matHeaderCellDef mat-sort-header>Cantidad</th>
                                                                    <td mat-cell *matCellDef="let element">{{element.Cantidad}}</td>
                                                                </ng-container>
                                                                <ng-container matColumnDef="PU">
                                                                    <th mat-header-cell *matHeaderCellDef mat-sort-header>P/U</th>
                                                                    <td mat-cell *matCellDef="let element"><span *ngIf="MonedaBoolean == true">{{element.PrecioUnitario | currency }}</span><span *ngIf="MonedaBoolean == false">{{element.PrecioUnitarioDlls | currency}}</span></td>
                                                                    <!-- <td mat-cell *matCellDef="let element"></td> -->
                                                                </ng-container>
                                                                <!-- <ng-container matColumnDef="PU" *ngIf="MonedaBoolean == false">
                                                                    <th mat-header-cell *matHeaderCellDef mat-sort-header>P/U</th>
                                                                    <td mat-cell *matCellDef="let element">{{element.PrecioUnitarioDlls | currency}}</td>
                                                                </ng-container> -->
                                                                <ng-container matColumnDef="Importe">
                                                                    <th mat-header-cell *matHeaderCellDef mat-sort-header>Importe</th>
                                                                    <td mat-cell *matCellDef="let element"><span *ngIf="MonedaBoolean == true">{{element.Importe | currency }}</span><span *ngIf="MonedaBoolean == false">{{element.ImporteDlls | currency}}</span></td>
                                                                </ng-container>
                                                                <!-- <ng-container matColumnDef="Importe" *ngIf="MonedaBoolean == false">
                                                                    <th mat-header-cell *matHeaderCellDef mat-sort-header>Importe</th>
                                                                    <td mat-cell *matCellDef="let element">{{element.ImporteDlls | currency}}</td>
                                                                </ng-container> -->

                                                                <ng-container matColumnDef="Options">
                                                                    <th mat-header-cell *matHeaderCellDef>OPCIONES</th>
                                                                    <td mat-cell *matCellDef="let row">
                                                                        <button [style.display]="clienteLogin ? 'none' : 'block'" mat-icon-button [matMenuTriggerFor]="menu" aria-label="Example icon-button with a menu">
                                                <mat-icon>keyboard_arrow_down</mat-icon>
                                              </button>
                                                                        <mat-menu #menu="matMenu">

                                                                            <button [disabled]="editarPrecio == false" mat-icon-button class="btn btn-dark" (click)="OnEditProducto(row)">
                                                  <mat-icon>edit</mat-icon>
                                                </button>


                                                                            <button *ngIf="this.service.formDataPedido.Estatus != 'Cerrada'" mat-icon-button class="btn btn-danger" (click)="onDeleteDetalleProducto(row)">
                                                  <mat-icon>delete_outline</mat-icon>
                                                </button>
                                                                        </mat-menu>
                                                                    </td>
                                                                </ng-container>
                                                            </table>
                                                        </div>
                                                    </div>
                                                </div>
                                                <!-- <button class="m-3" mat-raised-button color="primary" type="submit" [disabled]="form.invalid">Agregar Producto</button> -->
                                            </div>
                                            <!-- Tabla de costos finales -->

                                            <div class="container row">
                                                <div class="col-md-8 col-12">
                                                    <div class="container row">
                                                        <div class="col-md-6 col-12" style="display: grid">
                                                            <br>
                                                            <button class="btn btn-info btn-lg" mat-raised-button matStepperPrevious><i class="mdi mdi-arrow-left-bold-circle btn-lg"></i>Atras</button>
                                                            <br>
                                                            <button *ngIf="this.service.formDataPedido.Estatus == 'Guardada' || this.service.formDataPedido.Estatus == 'Cerrada'" class="btn btn-info btn-lg" mat-raised-button (click)="verPDF()"><i class="mdi mdi-file-pdf btn-lg"></i>Ver PDF</button>
                                                            <br>
                                                            <button *ngIf="this.service.formDataPedido.Estatus == 'Guardada' || this.service.formDataPedido.Estatus == 'Cerrada'" class="btn btn-info btn-lg" mat-raised-button (click)="enviarPedido()"><i class="mdi mdi-email btn-lg"></i>Enviar</button>
                                                            <br>
                                                            <!-- <button *ngIf="this.service.formDataPedido.Estatus == 'Guardada' || this.service.formDataPedido.Estatus == 'Cerrada'" class="btn btn-info btn-lg" mat-raised-button (click)="enviarPedidoAuto()"><i class="mdi mdi-email btn-lg"></i>Enviar Auto</button> -->
                                                            <br>
                                                            <!-- <button *ngIf="this.service.formDataPedido.Estatus == 'Guardada' || this.service.formDataPedido.Estatus == 'Cerrada'" class="btn btn-info btn-lg" mat-raised-button (click)="crearValidacion()"><i class="mdi mdi-email btn-lg"></i>Validacion</button> -->
                                                            <br>
                                                            <!-- <button class="btn btn-info btn-lg" mat-raised-button><i class="mdi mdi-email btn-lg" ></i>Whatsapp<a href='https://api.whatsapp.com/send?phone=526146068648&text={{this.url}}'></a></button> -->

                                                            <!--   <button *ngIf="this.service.formDataPedido.Estatus == 'Guardada' || this.service.formDataPedido.Estatus == 'Cerrada'" class="btn btn-info btn-lg" mat-raised-button><i class="mdi mdi-email btn-lg"></i>
                                                                <a href='https://api.whatsapp.com/send?phone=526146068648&text={{this.url}}' target="_blank"> Whatsapp</a>
                                                            </button> -->


                                                        </div>
                                                        <!-- <div class="col-4"></div> -->
                                                        <div class="col-md-6 col-12" style="display: grid">
                                                            <br>
                                                            <!-- <button matStepperNext class="btn btn-info btn-md" (click)="crearPedido()">Generar Pedido</button> -->
                                                            <button [disabled]="Guardar == false" *ngIf="this.service.formDataPedido.Estatus == 'Guardada' || this.service.formDataPedido.Estatus == 'Creada'" class="btn btn-info btn-lg" mat-raised-button (click)="crearPedido()"><i class="mdi mdi-send btn-lg"></i>Guardar</button>
                                                            <br>
                                                            <button [disabled]="Cerrar == false" *ngIf="this.service.formDataPedido.Estatus == 'Guardada'" class="btn btn-info btn-lg" mat-raised-button (click)="cerrarPedido()"><i class="mdi mdi-lock btn-lg"></i>Cerrar</button>
                                                            <br>
                                                            <button *ngIf="this.service.formDataPedido.Estatus == 'Guardada'" class="btn btn-info btn-lg" mat-raised-button (click)="verlistdata()"><i class="mdi mdi-lock btn-lg"></i>VERL</button>
                                                            <br>
                                                            <!-- <button class="btn btn-info btn-lg" mat-raised-button (click)="convertirPedido()"><i class="mdi mdi-forward btn-lg"></i>Convertir</button> -->
                                                            <!-- <button *ngIf="this.service.formDataPedido.Estatus == 'Guardada'" class="btn btn-info btn-lg" mat-raised-button (click)="convertirPedido()"><i class="mdi mdi-forward btn-lg"></i>Convertir</button> -->
                                                        </div>

                                                    </div>
                                                </div>
                                                <div class="col-md-4 col-12">
                                                    <br>
                                                    <div class="form-material borderbox">
                                                        <div class="container">
                                                            <div class="row">

                                                                <div *ngIf="MonedaBoolean == true; else elseBlock">

                                                                    <label class="input-group-text text-info col-12 col-md-6 col-lg-6">SubTotal</label>
                                                                    <input class="form-control col-12 col-md-6 col-lg-6" readonly="readonly" name="SubTotal" [ngModel]="MonedaBoolean ==  true ? (subtotal | currency) : (subtotalDlls | currency)">

                                                                    <label class="input-group-text text-info col-12 col-md-6 col-lg-6">Descuento</label>
                                                                    <input class="form-control col-12 col-md-6 col-lg-6" readonly="readonly" name="Descuento" [ngModel]="MonedaBoolean ==  true ? (descuento | currency) : (descuentoDlls | currency)">

                                                                    <label class="input-group-text text-info col-12 col-md-6 col-lg-6">Total</label>
                                                                    <input class="form-control col-12 col-md-6 col-lg-6" readonly="readonly" name="Total" #Total="ngModel" [ngModel]="MonedaBoolean ==  true ? (total | currency) : (totalDlls | currency)">

                                                                </div>

                                                                <ng-template #elseBlock>

                                                                    <label class="input-group-text text-info col-12 col-md-6 col-lg-6">SubTotal Dlls</label>
                                                                    <input class="form-control col-12 col-md-6 col-lg-6" readonly="readonly" name="SubTotalDlls" [ngModel]="subtotalDlls | currency">

                                                                    <label class="input-group-text text-info col-12 col-md-6 col-lg-6">Descuento Dlls</label>
                                                                    <input class="form-control col-12 col-md-6 col-lg-6" readonly="readonly" name="DescuentoDlls" [ngModel]="descuentoDlls | currency">

                                                                    <label class="input-group-text text-info col-12 col-md-6 col-lg-6">Total Dlls</label>
                                                                    <input class="form-control col-12 col-md-6 col-lg-6" readonly="readonly" name="TotalDlls" #TotalDlls="ngModel" [ngModel]="totalDlls | currency">

                                                                </ng-template>

                                                            </div>

                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                            <!--        
                                                    </div>


                                                </div> -->
                                            <!-- 
                                                <div class="container row">
                                                    <div class="col-12 col-md-4">
                                                        <br>
                                                        <button matStepperPrevious class="btn btn-primary btn-md">Back</button>
                                                    </div>
                                                    <div class="col-4"></div>
                                                    <div class="col-12 col-md-4">
                                                        <br>
                                                        <button [style.display]="clienteLogin ? 'none' : 'block'" matStepperNext class="btn btn-info btn-md" (click)="crearPedido()">Generar Pedido</button>
                                                    </div>
                                                </div> -->








                                        </mat-step>


                                    </mat-horizontal-stepper>


                                </div>
                            </section>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>
</div>